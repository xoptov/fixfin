{% extends "AppBundle::layout.html.twig" %}

{% block content %}
    <ul class="nav nav-tabs">
    {% for rate in rates %}
        <li class="{% if loop.first %}active{% endif %}">
            <a href="#table_{{ rate.id }}">{{ rate.name }}</a>
        </li>
    {% endfor %}
    </ul>
    <div class="tab-content">
    {% for rate in rates %}
        {% set ticket_activated = false %}
        <div class="tab-pane{% if loop.first %} active{% endif %} col-lg-12" id="table_{{ rate.id }}">
        {% for ticket in tickets %}
            {% if ticket.rate == rate %}
                {% set ticket_activated = ticket %}
            {% endif %}
        {% endfor %}
        {% if ticket_activated %}
            <div class="row">
                <div class="col-lg-6 table-activated">Стол активен до: {{ ticket_activated.expired|date("d-m-Y H:i") }}</div>
                <div class="col-lg-6">
                    <a class="btn btn-primary" href="{{ path('dashboard_prolong') }}">Продлить</a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    {# todo необходимо таблицу рэндерить в отдельном контроллере #}
                    <table class="table">
                        <thead>
                        <tr>
                            <th>№</th>
                            <th>ID</th>
                            <th>Имя Фамилия</th>
                            <th>Почта</th>
                            <th>Телефон</th>
                            <th>Квалификация</th>
                            <th>Кол. реф.</th>
                            <th>Статус</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>585</td>
                            <td>Иванов И.</td>
                            <td>ivanov@mail.ru</td>
                            <td>+7 000 000 0000</td>
                            <td>выполнена</td>
                            <td>15</td>
                            <td>активен</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        {% else %}
            <div class="row">
                <div class="col-lg-9 col-md-8 col-sm-8 col-xs-8 table-activated">{{ rate.name }} неактивен!</div>
                <div class="col-lg-3 col-md-4 col-sm-4 col-xs-4 text-right">
                    <a class="btn btn-primary" href="{{ path('dashboard_open', {'rate': rate.id}) }}">Активировать</a>
                </div>
            </div>
        {% endif %}
        </div>
    {% endfor %}
    </div>
{% endblock %}

{% block javascripts %}
    <script>
        var dashboard = modulejs.require('dashboard');
        dashboard.start();
    </script>
{% endblock %}