services:
    app.referrer_listener:
        class: AppBundle\EventListener\ReferrerSubscriber
        arguments:
            - @doctrine.orm.default_entity_manager
        tags:
            - { name: kernel.event_subscriber }

    app.registration.form.handler:
        class: AppBundle\Form\Handler\RegistrationFormHandler
        arguments:
            - "@fos_user.registration.form"
            - "@request"
            - "@fos_user.user_manager"
            - "@fos_user.mailer"
            - "@fos_user.util.token_generator"
        scope: request
        public: false

    app.admin.pool:
        class: AppBundle\Admin\PoolAdmin
        arguments: [~, AppBundle\Entity\Pool, ~]
        tags:
            - { name: sonata.admin, manager_type: orm, label: Pool }
        calls:
            - [setEntityManager, [@doctrine.orm.default_entity_manager]]

    app.admin.rate:
        class: AppBundle\Admin\RateAdmin
        arguments: [~, AppBundle\Entity\Rate, ~]
        tags:
            - { name: sonata.admin, manager_type: orm, label: Rate }

    app.admin.user:
        class: AppBundle\Admin\UserAdmin
        arguments: [~, AppBundle\Entity\User, ~]
        tags:
            - { name: sonata.admin, manager_type: orm, label: User }
        calls:
            - [setUserManager, [@fos_user.user_manager]]
            - [setEntityManager, [@doctrine.orm.default_entity_manager]]

    app.admin.account:
        class: AppBundle\Admin\AccountAdmin
        arguments: [~, AppBundle\Entity\Account, ~]
        tags:
            - { name: sonata.admin, manager_type: orm, label: Account }

    app.admin.money_transaction:
            class: AppBundle\Admin\MoneyTransactionAdmin
            arguments: [~, AppBundle\Entity\MoneyTransaction, ~]
            tags:
                - { name: sonata.admin, manager_type: orm, label: Transaction }
